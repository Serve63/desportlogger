<!doctype html>
<html lang="nl">
<head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />

  <meta name="theme-color" content="#1f2126" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
 <title>Logboek - Maandag</title> 
  
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700&family=Sora:wght@400;500;600&display=swap");

    :root {
      --ink: #eef0f3;
      --muted: #c2c6cc;
      --line: #6a6f78;
      --stroke: #7a8089;
      --field: #3b3f45;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      overflow: hidden;
      position: fixed;
      width: 100%;
      touch-action: none;
    }

    body::-webkit-scrollbar {
      width: 0;
      height: 0;
    }

    body {
      margin: 0;
      font-family: "Sora", system-ui, sans-serif;
      color: var(--ink);
      background: #1f2126;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 40px 12px 48px;
    }

    .sheet {
      width: min(980px, 100%);
      padding: 8px 2px 18px;
      position: relative;
    }

    header {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      text-align: center;
      margin-bottom: 18px;
      position: relative;
      z-index: 1;
    }

    h1 {
      font-family: "Cormorant Garamond", serif;
      font-size: clamp(2.2rem, 3.8vw, 3.4rem);
      margin: 0;
      letter-spacing: 0.02em;
    }

    .training-count {
      margin-top: 72px;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--muted);
    }

    .year-trigger {
      background: none;
      border: none;
      padding: 0;
      margin: 0;
      font: inherit;
      color: var(--ink);
      font-weight: 700;
      letter-spacing: 0.18em;
      cursor: pointer;
    }

    .day-line {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 6px;
      margin-bottom: 10px;
    }

    .day-trigger {
      background: none;
      border: none;
      padding: 0;
      margin: 0;
      font: inherit;
      color: var(--ink);
      font-weight: 400;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      font-size: 0.7rem;
      cursor: pointer;
    }

    .grid {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .header-row {
      display: grid;
      grid-template-columns: minmax(0, 2fr) 42px 42px 42px;
      column-gap: 8px;
      align-items: end;
    }

    .grid .header {
      font-weight: 600;
      text-transform: uppercase;
      font-size: 0.5rem;
      letter-spacing: 0.12em;
      color: var(--muted);
      padding-bottom: 6px;
      text-align: center;
    }

    .grid .header.exercise-header {
      text-align: left;
    }

    .row {
      display: grid;
      grid-template-columns: minmax(0, 2fr) 42px 42px 42px;
      column-gap: 8px;
      row-gap: 10px;
      align-items: start;
    }

    .exercise-cell {
      display: flex;
      flex-direction: column;
      gap: 4px;
      min-width: 0;
    }

    .exercise-cell .exercise-name,
    .exercise-cell .exercise-note {
      border: none;
      background: transparent;
      padding: 2px 0;
      color: var(--ink);
      font: inherit;
    }

    .exercise-cell .exercise-name {
      font-size: 0.72rem;
      font-weight: 500;
    }

    .exercise-cell .exercise-note {
      color: #c6c8cc;
      font-size: 0.65rem;
    }

    .mini-wrap {
      display: flex;
      justify-content: center;
    }

    .mini-field {
      border: none;
      background: var(--field);
      border-radius: 6px;
      width: 42px;
      height: 42px;
      padding: 0;
      text-align: center;
      font-size: 0.75rem;
      line-height: 1;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: var(--ink);
    }

    .year-modal,
    .day-modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(10, 10, 12, 0.45);
      z-index: 1000;
      padding: 24px;
    }

    .year-modal.is-open,
    .day-modal.is-open {
      display: flex;
    }

    .year-modal__content,
    .day-modal__content {
      width: min(420px, 100%);
      background: #3b3f45;
      color: #f1f2f4;
      border-radius: 14px;
      padding: 20px 20px 18px;
      border: 1px solid #b9bcc3;
      box-shadow: 0 14px 28px rgba(0, 0, 0, 0.35);
      position: relative;
    }

    .year-modal__content h2,
    .day-modal__content h2 {
      margin: 0 0 12px;
      font-size: 1.05rem;
    }

    .year-modal__list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: 8px;
      font-size: 0.95rem;
    }

    .year-total {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid #b9bcc3;
    }

    .day-modal__grid {
      display: grid;
      gap: 8px;
    }

    .day-modal__grid a {
      text-decoration: none;
      color: #f1f2f4;
      background: #2f3338;
      border: 1px solid #b9bcc3;
      border-radius: 10px;
      padding: 8px 10px;
      font-weight: 600;
      text-align: center;
    }

    .day-modal__grid a:hover {
      background: #3b3f45;
    }

    .exercise-modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(10, 10, 12, 0.45);
      z-index: 1000;
      padding: 24px;
    }

    .exercise-modal.is-open {
      display: flex;
    }

    .exercise-modal__content {
      width: min(320px, 90%);
      background: #3b3f45;
      color: #f1f2f4;
      border-radius: 14px;
      padding: 20px 20px 18px;
      border: 1px solid #b9bcc3;
      box-shadow: 0 14px 28px rgba(0, 0, 0, 0.35);
      position: relative;
    }

    .exercise-modal__content h2 {
      margin: 0 0 16px;
      font-size: 1.05rem;
    }

    .exercise-modal__actions {
      display: grid;
      gap: 10px;
    }

    .exercise-modal__actions button {
      text-decoration: none;
      color: #f1f2f4;
      background: #2f3338;
      border: 1px solid #b9bcc3;
      border-radius: 10px;
      padding: 12px 16px;
      font-weight: 600;
      text-align: center;
      font-size: 0.95rem;
      cursor: pointer;
      font-family: inherit;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }

    .exercise-modal__actions button:hover {
      background: #3b3f45;
    }

    .exercise-modal__actions button.delete {
      color: #ff6b6b;
      border-color: #ff6b6b;
    }

    .exercise-modal__actions button.delete:hover {
      background: rgba(255, 107, 107, 0.1);
    }

    .year-modal__close,
    .day-modal__close,
    .exercise-modal__close {
      position: absolute;
      top: 10px;
      right: 12px;
      border: none;
      background: transparent;
      font-size: 1.5rem;
      cursor: pointer;
      color: #f1f2f4;
    }

    .footer-toggle {
      position: fixed;
      bottom: 24px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      pointer-events: auto;
      z-index: 1000;
    }

    .footer-check {
      pointer-events: auto;
      width: 36px;
      height: 36px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: #2f3338;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      position: relative;
    }

    .footer-check.is-on {
      background: #2ea043;
      border-color: #2ea043;
    }

    .footer-check.is-on::after {
      content: "✓";
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 700;
      color: #eaffef;
    }

    @media (max-width: 720px) {
      body {
        padding: 16px 16px 70px;
      }

      header {
        gap: 6px;
        margin-bottom: 12px;
      }

      h1 {
        font-size: clamp(1.8rem, 6vw, 2.2rem);
      }

      .training-count {
        margin-top: 12px;
        font-size: 0.7rem;
        letter-spacing: 0.14em;
      }

      .header-row {
        grid-template-columns: minmax(0, 1.4fr) 40px 40px 40px;
        column-gap: 10px;
      }

      .row {
        grid-template-columns: minmax(0, 1.4fr) 40px 40px 40px;
        column-gap: 10px;
      }

      .mini-field {
        width: 40px;
        height: 40px;
        font-size: 16px !important;
      }

      .exercise-cell .exercise-name {
        font-size: 16px !important;
      }

      .exercise-cell .exercise-note {
        font-size: 14px !important;
      }
    }

    @media (max-width: 520px) {
      .header-row {
        grid-template-columns: minmax(0, 1fr) 36px 36px 36px;
        column-gap: 8px;
      }

      .row {
        grid-template-columns: minmax(0, 1fr) 36px 36px 36px;
        column-gap: 8px;
      }

      .mini-field {
        width: 36px;
        height: 36px;
        font-size: 16px !important;
      }

      .exercise-cell .exercise-name {
        font-size: 16px !important;
      }

      .exercise-cell .exercise-note {
        font-size: 14px !important;
      }
    }
  

    .confetti-layer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      margin: 0;
      padding: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 9999;
    }

    .confetti {
      position: absolute;
      top: -20px;
      opacity: 0;
      animation: confettiFall var(--fall-duration, 4s) var(--fall-delay, 0s) ease-out forwards;
    }

    @keyframes confettiFall {
      0% {
        opacity: 1;
        transform: translateY(0) translateX(0) rotateX(0deg) rotateY(0deg) rotateZ(0deg);
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        opacity: 0;
        transform:
          translateY(calc(100vh + 50px))
          translateX(var(--sway, 0px))
          rotateX(var(--spin-x, 720deg))
          rotateY(var(--spin-y, 540deg))
          rotateZ(var(--spin-z, 360deg));
      }
    }

</style>

</head>
<body> <main class="sheet"> <header> <div> <div class="training-count"><button class="year-trigger" type="button">2026:</button> 27 sessies</div> <h1>Servé's Logboek</h1> <div class="day-line"><button class="day-trigger" type="button">Maandag</button></div></div>
</header> <section class="grid" aria-label="Oefeningen">
      <div class="header-row">
        <div class="header exercise-header"></div> <div class="header">SETS</div> <div class="header">REPS</div> <div class="header">KG</div></div> <div class="row"> <div class="exercise-cell"> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" class="exercise-name" type="text" name="oefening-1" value="Abdominal Machine" /> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" type="text" class="exercise-note" name="note-1" /></div> <div class="mini-wrap" data-label="Sets"><input type="text" class="mini-field" name="sets-1" data-max="9" inputmode="numeric" pattern="[0-9]*" maxlength="1" value="3" /></div> <div class="mini-wrap" data-label="Reps"><input type="text" class="mini-field" name="reps-1" data-max="30" inputmode="numeric" pattern="[0-9]*" maxlength="2" /></div> <div class="mini-wrap" data-label="Gewicht"><input type="text" class="mini-field" name="gewicht-1" data-max="999" inputmode="numeric" pattern="[0-9]*" maxlength="3" /></div></div> <div class="row"> <div class="exercise-cell"> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" class="exercise-name" type="text" name="oefening-2" value="Standing Buik" /> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" type="text" class="exercise-note" name="note-2" /></div> <div class="mini-wrap" data-label="Sets"><input type="text" class="mini-field" name="sets-2" data-max="9" inputmode="numeric" pattern="[0-9]*" maxlength="1" value="3" /></div> <div class="mini-wrap" data-label="Reps"><input type="text" class="mini-field" name="reps-2" data-max="30" inputmode="numeric" pattern="[0-9]*" maxlength="2" /></div> <div class="mini-wrap" data-label="Gewicht"><input type="text" class="mini-field" name="gewicht-2" data-max="999" inputmode="numeric" pattern="[0-9]*" maxlength="3" /></div></div> <div class="row"> <div class="exercise-cell"> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" class="exercise-name" type="text" name="oefening-3" value="Chest Press" /> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" type="text" class="exercise-note" name="note-3" /></div> <div class="mini-wrap" data-label="Sets"><input type="text" class="mini-field" name="sets-3" data-max="9" inputmode="numeric" pattern="[0-9]*" maxlength="1" value="3" /></div> <div class="mini-wrap" data-label="Reps"><input type="text" class="mini-field" name="reps-3" data-max="30" inputmode="numeric" pattern="[0-9]*" maxlength="2" /></div> <div class="mini-wrap" data-label="Gewicht"><input type="text" class="mini-field" name="gewicht-3" data-max="999" inputmode="numeric" pattern="[0-9]*" maxlength="3" /></div></div> <div class="row"> <div class="exercise-cell"> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" class="exercise-name" type="text" name="oefening-4" value="Incline Chest" /> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" type="text" class="exercise-note" name="note-4" /></div> <div class="mini-wrap" data-label="Sets"><input type="text" class="mini-field" name="sets-4" data-max="9" inputmode="numeric" pattern="[0-9]*" maxlength="1" value="3" /></div> <div class="mini-wrap" data-label="Reps"><input type="text" class="mini-field" name="reps-4" data-max="30" inputmode="numeric" pattern="[0-9]*" maxlength="2" /></div> <div class="mini-wrap" data-label="Gewicht"><input type="text" class="mini-field" name="gewicht-4" data-max="999" inputmode="numeric" pattern="[0-9]*" maxlength="3" /></div></div> <div class="row"> <div class="exercise-cell"> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" class="exercise-name" type="text" name="oefening-5" value="Overhead Triceps" /> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" type="text" class="exercise-note" name="note-5" /></div> <div class="mini-wrap" data-label="Sets"><input type="text" class="mini-field" name="sets-5" data-max="9" inputmode="numeric" pattern="[0-9]*" maxlength="1" value="3" /></div> <div class="mini-wrap" data-label="Reps"><input type="text" class="mini-field" name="reps-5" data-max="30" inputmode="numeric" pattern="[0-9]*" maxlength="2" /></div> <div class="mini-wrap" data-label="Gewicht"><input type="text" class="mini-field" name="gewicht-5" data-max="999" inputmode="numeric" pattern="[0-9]*" maxlength="3" /></div></div> <div class="row"> <div class="exercise-cell"> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" class="exercise-name" type="text" name="oefening-6" value="Tricep Dip" /> <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" type="text" class="exercise-note" name="note-6" /></div> <div class="mini-wrap" data-label="Sets"><input type="text" class="mini-field" name="sets-6" data-max="9" inputmode="numeric" pattern="[0-9]*" maxlength="1" value="3" /></div> <div class="mini-wrap" data-label="Reps"><input type="text" class="mini-field" name="reps-6" data-max="30" inputmode="numeric" pattern="[0-9]*" maxlength="2" /></div> <div class="mini-wrap" data-label="Gewicht"><input type="text" class="mini-field" name="gewicht-6" data-max="999" inputmode="numeric" pattern="[0-9]*" maxlength="3" /></div></div></section></main> <div class="year-modal" id="yearModal" aria-hidden="true"> <div class="year-modal__content" role="dialog" aria-modal="true" aria-labelledby="yearModalTitle"> <button class="year-modal__close" type="button" aria-label="Sluiten">&times;</button> <h2 id="yearModalTitle">Voorgaande jaren</h2> <ul class="year-modal__list"> <li><strong>2022:</strong> 10</li> <li><strong>2023:</strong> 5</li> <li><strong>2024:</strong> 22</li> <li><strong>2025:</strong> 301</li> <li><strong>2026 (tot heden):</strong> 20</li> <li class="year-total"><strong>Totaal:</strong> 358 sessies</li></ul></div></div>

  <div class="day-modal" id="dayModal" aria-hidden="true">
    <div class="day-modal__content" role="dialog" aria-modal="true" aria-labelledby="dayModalTitle">
      <button class="day-modal__close" type="button" aria-label="Sluiten">&times;</button>
      <h2 id="dayModalTitle">Kies een dag</h2>
      <div class="day-modal__grid">
        <a href="index.html">Maandag</a>
        <a href="dinsdag.html">Dinsdag</a>
        <a href="woensdag.html">Woensdag</a>
        <a href="donderdag.html">Donderdag</a>
        <a href="zaterdag.html">Zaterdag</a>
        <a href="zondag.html">Zondag</a>
      </div>
    </div>
  </div>

  <div class="exercise-modal" id="exerciseModal" aria-hidden="true">
    <div class="exercise-modal__content" role="dialog" aria-modal="true">
      <button class="exercise-modal__close" type="button" aria-label="Sluiten">&times;</button>
      <div class="exercise-modal__actions">
        <button type="button" class="add-exercise">Nieuwe oefening toevoegen</button>
        <button type="button" class="delete-exercise delete">Oefening verwijderen</button>
      </div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  
  <script>
    (() => {

      const dayTrigger = document.querySelector(".day-trigger");
      const dayModal = document.getElementById("dayModal");
      const dayClose = document.querySelector(".day-modal__close");

      if (dayTrigger && dayModal && dayClose) {
        const openDayModal = () => {
          dayModal.classList.add("is-open");
          dayModal.setAttribute("aria-hidden", "false");
        };
        const closeDayModal = () => {
          dayModal.classList.remove("is-open");
          dayModal.setAttribute("aria-hidden", "true");
        };

        dayTrigger.addEventListener("click", () => {
          if (dayModal.classList.contains("is-open")) {
            closeDayModal();
          } else {
            openDayModal();
          }
        });
        dayClose.addEventListener("click", closeDayModal);
        dayModal.addEventListener("click", (event) => {
          if (event.target === dayModal) closeDayModal();
        });
        document.addEventListener("keydown", (event) => {
          if (event.key === "Escape") closeDayModal();
        });
      }

      const setupYearTrigger = () => {
      const yearTrigger = document.querySelector(".year-trigger");
      const yearModal = document.getElementById("yearModal");
      const yearClose = document.querySelector(".year-modal__close");

      if (yearTrigger && yearModal && yearClose) {
        const openModal = () => {
          yearModal.classList.add("is-open");
          yearModal.setAttribute("aria-hidden", "false");
        };
        const closeModal = () => {
          yearModal.classList.remove("is-open");
          yearModal.setAttribute("aria-hidden", "true");
        };

          // Verwijder oude event listeners door te clonen
          const newYearTrigger = yearTrigger.cloneNode(true);
          yearTrigger.parentNode.replaceChild(newYearTrigger, yearTrigger);

          newYearTrigger.addEventListener("click", () => {
          if (yearModal.classList.contains("is-open")) {
            closeModal();
          } else {
            openModal();
          }
        });
          
          // Setup close button en modal events (alleen eenmalig)
          if (!yearClose.dataset.listenerAttached) {
        yearClose.addEventListener("click", closeModal);
            yearClose.dataset.listenerAttached = "true";
        yearModal.addEventListener("click", (event) => {
          if (event.target === yearModal) closeModal();
        });
        document.addEventListener("keydown", (event) => {
          if (event.key === "Escape") closeModal();
        });
      }
        }
      };

      // Initialiseer year trigger bij het laden
      setupYearTrigger();


      const clampInput = (input) => {
        const max = Number(input.dataset.max || 999);
        input.addEventListener("input", () => {
          let value = input.value.replace(/\D+/g, "");
          if (value === "") {
            input.value = "";
            return;
          }
          const num = Number(value);
          input.value = String(Math.min(num, max));
        });
      };

      document.querySelectorAll("input[data-max]").forEach(clampInput);

      const launchConfetti = () => {
        const layer = document.createElement("div");
        layer.className = "confetti-layer";
        document.documentElement.appendChild(layer);

        const viewportWidth = window.innerWidth || document.documentElement.clientWidth;

        // Feestelijke kleuren
        const colors = [
          '#2ea043', // groen (primair)
          '#58d68d', // licht groen
          '#f39c12', // goud/oranje
          '#e74c3c', // rood
          '#3498db', // blauw
          '#9b59b6', // paars
          '#1abc9c', // turquoise
          '#f1c40f', // geel
        ];

        const shapes = ['rect', 'square', 'circle'];

        const createConfettiPiece = () => {
          const piece = document.createElement("span");
          piece.className = "confetti";

          // Willekeurige positie over hele breedte
          const x = Math.random() * viewportWidth;
          piece.style.left = x + "px";

          // Willekeurige kleur
          const color = colors[Math.floor(Math.random() * colors.length)];
          piece.style.background = color;

          // Willekeurige vorm en grootte
          const shape = shapes[Math.floor(Math.random() * shapes.length)];
          const baseSize = 6 + Math.random() * 8;

          if (shape === 'rect') {
            piece.style.width = baseSize + "px";
            piece.style.height = (baseSize * 1.5) + "px";
            piece.style.borderRadius = "2px";
          } else if (shape === 'square') {
            piece.style.width = baseSize + "px";
            piece.style.height = baseSize + "px";
            piece.style.borderRadius = "2px";
          } else {
            piece.style.width = baseSize + "px";
            piece.style.height = baseSize + "px";
            piece.style.borderRadius = "50%";
          }

          // Variabele valsnelheid (2.5s tot 5s)
          const fallDuration = 2.5 + Math.random() * 2.5;
          piece.style.setProperty('--fall-duration', fallDuration + 's');

          // Willekeurige delay voor spreiding
          const delay = Math.random() * 0.8;
          piece.style.setProperty('--fall-delay', delay + 's');

          // Horizontale sway (-80px tot +80px)
          const sway = (Math.random() - 0.5) * 160;
          piece.style.setProperty('--sway', sway + 'px');

          // Willekeurige 3D rotaties
          piece.style.setProperty('--spin-x', (360 + Math.random() * 720) + 'deg');
          piece.style.setProperty('--spin-y', (360 + Math.random() * 540) + 'deg');
          piece.style.setProperty('--spin-z', (180 + Math.random() * 540) + 'deg');

          return piece;
        };

        const createConfettiBatch = (count) => {
          for (let i = 0; i < count; i++) {
            layer.appendChild(createConfettiPiece());
          }
        };

        // Initiële burst
        createConfettiBatch(80);

        // Continue stroom voor 4 seconden
        let elapsed = 0;
        const interval = setInterval(() => {
          elapsed += 200;
          createConfettiBatch(15);

          if (elapsed >= 4000) {
            clearInterval(interval);
            // Verwijder layer nadat laatste confetti gevallen is
            setTimeout(() => layer.remove(), 6000);
          }
        }, 200);
      };

      if (!window.supabase) {
        console.error("Supabase library niet geladen!");
        return;
      }

      console.log("Supabase library gevonden, client aanmaken...");
      const supabase = window.supabase.createClient(
        "https://lqgcitosiyahgwqluwtb.supabase.co",
        "sb_publishable_dGMK5ruFsyWkF3ne43AS1A_lHURUBhI"
      );
      console.log("Supabase client aangemaakt");

      // Functie om sessie count op te halen en bij te werken
      const getSessionCount = async () => {
        try {
          const currentYear = new Date().getFullYear();
          const { data, error } = await supabase
            .from("session_counts")
            .select("count")
            .eq("year", currentYear)
            .single();
          
          if (error) {
            // PGRST116 = geen resultaten gevonden
            if (error.code === 'PGRST116' || error.message?.includes('No rows')) {
              console.log("No session count found, creating new record with 20");
              // Geen record gevonden, maak nieuwe aan met count 20
              const { data: newData, error: insertError } = await supabase
                .from("session_counts")
                .insert({ year: currentYear, count: 20 })
                .select()
                .single();
              
              if (insertError) {
                console.error("Error creating session count:", insertError);
                return 20; // Fallback
              }
              
              return newData?.count || 20;
            } else {
              console.error("Error getting session count:", error);
              return 20; // Fallback
            }
          }
          
          return data?.count || 20;
        } catch (error) {
          console.error("Error in getSessionCount:", error);
          return 20; // Fallback
        }
      };

      // Functie om sessie count te resetten naar 20
      const resetSessionCountTo20 = async () => {
        try {
          const currentYear = new Date().getFullYear();
          const { error } = await supabase
            .from("session_counts")
            .upsert({ year: currentYear, count: 20 }, { onConflict: 'year' });
          
          if (error) {
            console.error("Error resetting session count:", error);
            return;
          }
          
          console.log("Session count reset to 20");
          updateSessionCountDisplay(20);
        } catch (error) {
          console.error("Error in resetSessionCountTo20:", error);
        }
      };

      const updateSessionCount = async (increment = true) => {
        try {
          console.log(increment ? "incrementSessionCount called" : "decrementSessionCount called");
          const currentYear = new Date().getFullYear();
          console.log("Current year:", currentYear);
          
          const currentCount = await getSessionCount();
          console.log("Current count:", currentCount);
          
          const newCount = increment ? currentCount + 1 : Math.max(0, currentCount - 1);
          console.log("New count:", newCount);
          
          const { data, error } = await supabase
            .from("session_counts")
            .upsert({ year: currentYear, count: newCount }, { onConflict: 'year' });
          
          if (error) {
            console.error("Error updating session count:", error);
            if (error.message?.includes("Could not find the table") || error.message?.includes("relation") || error.message?.includes("does not exist")) {
              alert("De session_counts tabel bestaat nog niet in Supabase. Voer de SQL uit uit supabase.sql om de tabel aan te maken.");
            } else {
              alert("Fout bij updaten sessie count: " + error.message);
            }
            return;
          }
          
          console.log("Session count updated successfully:", data);
          updateSessionCountDisplay(newCount);
        } catch (error) {
          console.error("Error in updateSessionCount:", error);
          alert("Fout: " + error.message);
        }
      };

      const incrementSessionCount = () => updateSessionCount(true);
      const decrementSessionCount = () => updateSessionCount(false);


      const updateSessionCountDisplay = (count) => {
        const trainingCountEl = document.querySelector(".training-count");
        if (trainingCountEl) {
          const yearButton = trainingCountEl.querySelector(".year-trigger");
          const year = yearButton?.textContent?.replace(":", "") || new Date().getFullYear();
          trainingCountEl.innerHTML = `<button class="year-trigger" type="button">${year}:</button> ${count} sessies`;
          // Herstel de event listener na het updaten
          setupYearTrigger();
        }
      };

      // Initialiseer sessie counts voor alle jaren
      const initializeSessionCounts = async () => {
        const yearCounts = {
          2024: 22,
          2025: 301,
          2026: 20
        };

        for (const [year, count] of Object.entries(yearCounts)) {
          const { data, error } = await supabase
            .from("session_counts")
            .select("count")
            .eq("year", parseInt(year))
            .single();

          // Als er geen record is of de count verschilt, update
          if (error || !data || data.count !== count) {
            const { error: upsertError } = await supabase
              .from("session_counts")
              .upsert({ year: parseInt(year), count: count }, { onConflict: 'year' });
            
            if (upsertError) {
              console.error(`Error setting count for ${year}:`, upsertError);
            } else {
              console.log(`Set count for ${year} to ${count}`);
            }
          }
        }
      };

      // Laad de huidige sessie count en reset naar 20 als nodig
      (async () => {
        // Initialiseer eerst alle jaar counts
        await initializeSessionCounts();
        
        const count = await getSessionCount();
        // Als de count niet 20 is, reset naar 20
        if (count !== 20) {
          console.log(`Current count is ${count}, resetting to 20`);
          await resetSessionCountTo20();
        } else {
          updateSessionCountDisplay(count);
        }
      })();

      window.addEventListener("DOMContentLoaded", () => {
        const footerCheck = document.querySelector(".footer-check");
        if (!footerCheck) return;
        
        footerCheck.addEventListener("click", (e) => {
          e.preventDefault();
          console.log("Footer check clicked");
          const wasOn = footerCheck.classList.contains("is-on");
          const isOn = footerCheck.classList.toggle("is-on");
          console.log("wasOn:", wasOn, "isOn:", isOn);
          
          if (isOn && !wasOn) {
            // Verhogen wanneer het wordt aangezet
            console.log("Incrementing session count");
            incrementSessionCount();
            launchConfetti();
          } else if (!isOn && wasOn) {
            // Verlagen wanneer het wordt uitgezet
            console.log("Decrementing session count");
            decrementSessionCount();
          }
        });
      });

      const day = document.querySelector(".day-trigger")?.textContent?.trim() ||
        document.querySelector(".day-tag")?.textContent?.trim();
      const rows = Array.from(document.querySelectorAll(".row"));
      if (!day || rows.length === 0) return;

      const getRowData = (row, index) => {
        const nameInput = row.querySelector(".exercise-name");
        const noteInput = row.querySelector(".exercise-note");
        const setsInput = row.querySelector('input[name^="sets-"]');
        const repsInput = row.querySelector('input[name^="reps-"]');
        const weightInput = row.querySelector('input[name^="gewicht-"]');

        const toInt = (value) => {
          if (value === "" || value == null) return null;
          const num = Number(value);
          return Number.isNaN(num) ? null : num;
        };

        return {
          day,
          exercise_index: index + 1,
          exercise_name: nameInput?.value?.trim() || null,
          note: noteInput?.value?.trim() || null,
          sets: toInt(setsInput?.value),
          reps: toInt(repsInput?.value),
          weight: toInt(weightInput?.value),
        };
      };

      const upsertRow = async (row, index) => {
        const payload = getRowData(row, index);
        console.log("Saving data:", payload);
        const { data, error } = await supabase
          .from("workout_entries")
          .upsert(payload, { onConflict: "day,exercise_index" })
          .select();
        if (error) {
          console.error("Supabase save failed:", error);
          console.error("Payload was:", payload);
        } else {
          console.log("Saved successfully:", data);
        }
      };

      const getColumnForInput = (input) => {
        if (input.classList.contains("exercise-name")) return "exercise_name";
        if (input.classList.contains("exercise-note")) return "note";
        const name = input.getAttribute("name") || "";
        if (name.startsWith("sets-")) return "sets";
        if (name.startsWith("reps-")) return "reps";
        if (name.startsWith("gewicht-")) return "weight";
        return null;
      };

      const clearField = async (row, index, input) => {
        const column = getColumnForInput(input);
        if (!column) return;
        const { error } = await supabase
          .from("workout_entries")
          .update({ [column]: null })
          .match({ day, exercise_index: index + 1 });
        if (error) console.warn("Supabase clear failed", error);
      };

      const timers = new Map();
      const scheduleSave = (row, index, immediate = false) => {
        if (timers.has(index)) clearTimeout(timers.get(index));
        const delay = immediate ? 0 : 500;
        timers.set(index, setTimeout(() => upsertRow(row, index), delay));
      };

      // Functie om alle rows opnieuw te indexeren en op te slaan
      const reindexAndSaveAllRows = async () => {
        const allRows = Array.from(document.querySelectorAll(".row"));
        // Verwijder eerst alle oude entries voor deze dag
        await supabase.from("workout_entries").delete().eq("day", day);
        // Sla alle rows opnieuw op met nieuwe indices
        for (let i = 0; i < allRows.length; i++) {
          await upsertRow(allRows[i], i);
        }
      };

      // Functie om event listeners toe te voegen aan een row
      const attachRowEventListeners = (row, index) => {
        row.querySelectorAll("input").forEach((input) => {
          input.addEventListener("input", () => {
            const value = input.value ?? "";
            if (value === "") {
              clearField(row, index, input);
              scheduleSave(row, index, true);
              return;
            }
            scheduleSave(row, index, false);
          });
          input.addEventListener("blur", () => {
            scheduleSave(row, index, true);
          });
        });
      };

      rows.forEach((row, index) => {
        attachRowEventListeners(row, index);
      });

      // Exercise context menu functionaliteit (nu met toegang tot Supabase functies)
      const setupExerciseContextMenu = () => {
        const exerciseModal = document.getElementById("exerciseModal");
        const exerciseClose = document.querySelector(".exercise-modal__close");
        const addExerciseBtn = document.querySelector(".add-exercise");
        const deleteExerciseBtn = document.querySelector(".delete-exercise");
        let selectedRow = null;

        if (!exerciseModal || !exerciseClose || !addExerciseBtn || !deleteExerciseBtn) return;

        const openModal = (row) => {
          selectedRow = row;
          exerciseModal.classList.add("is-open");
          exerciseModal.setAttribute("aria-hidden", "false");
        };

        const closeModal = () => {
          exerciseModal.classList.remove("is-open");
          exerciseModal.setAttribute("aria-hidden", "true");
          selectedRow = null;
        };

        exerciseClose.addEventListener("click", closeModal);
        exerciseModal.addEventListener("click", (event) => {
          if (event.target === exerciseModal) closeModal();
        });
        document.addEventListener("keydown", (event) => {
          if (event.key === "Escape" && exerciseModal.classList.contains("is-open")) {
            closeModal();
          }
        });

        // Touch long press detection
        let touchTimer = null;
        const LONG_PRESS_DURATION = 500; // 500ms

        const handleTouchStart = (e, row) => {
          touchTimer = setTimeout(() => {
            e.preventDefault();
            openModal(row);
          }, LONG_PRESS_DURATION);
        };

        const handleTouchEnd = () => {
          if (touchTimer) {
            clearTimeout(touchTimer);
            touchTimer = null;
          }
        };

        const handleTouchMove = () => {
          if (touchTimer) {
            clearTimeout(touchTimer);
            touchTimer = null;
          }
        };

        // Functie om touch listeners toe te voegen aan een row
        const attachTouchListeners = (row) => {
          row.addEventListener("touchstart", (e) => handleTouchStart(e, row), { passive: false });
          row.addEventListener("touchend", handleTouchEnd);
          row.addEventListener("touchmove", handleTouchMove);
          row.addEventListener("touchcancel", handleTouchEnd);
        };

        // Voeg touch event listeners toe aan alle rows
        const allRows = document.querySelectorAll(".row");
        allRows.forEach((row) => {
          attachTouchListeners(row);
        });

        // Functie om oefening te verwijderen
        deleteExerciseBtn.addEventListener("click", async () => {
          if (selectedRow) {
            // Verwijder de row uit de DOM
            selectedRow.remove();
            closeModal();
            // Herindexeer en sla alle rows opnieuw op
            await reindexAndSaveAllRows();
          }
        });

        // Functie om nieuwe oefening toe te voegen
        addExerciseBtn.addEventListener("click", async () => {
          const grid = document.querySelector(".grid");
          if (!grid) return;

          // Bepaal het volgende nummer voor de nieuwe oefening
          const existingRows = document.querySelectorAll(".row");
          const nextIndex = existingRows.length + 1;

          // Maak nieuwe row
          const newRow = document.createElement("div");
          newRow.className = "row";
          newRow.innerHTML = `
            <div class="exercise-cell">
              <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" class="exercise-name" type="text" name="oefening-${nextIndex}" placeholder="Geef je oefening een naam" />
              <input spellcheck="false" autocapitalize="off" autocomplete="off" autocorrect="off" type="text" class="exercise-note" name="note-${nextIndex}" />
            </div>
            <div class="mini-wrap" data-label="Sets">
              <input type="text" class="mini-field" name="sets-${nextIndex}" data-max="9" inputmode="numeric" pattern="[0-9]*" maxlength="1" value="3" />
            </div>
            <div class="mini-wrap" data-label="Reps">
              <input type="text" class="mini-field" name="reps-${nextIndex}" data-max="30" inputmode="numeric" pattern="[0-9]*" maxlength="2" />
            </div>
            <div class="mini-wrap" data-label="Gewicht">
              <input type="text" class="mini-field" name="gewicht-${nextIndex}" data-max="999" inputmode="numeric" pattern="[0-9]*" maxlength="3" />
            </div>
          `;

          // Voeg toe aan het einde van de grid (na de laatste row)
          if (existingRows.length > 0) {
            existingRows[existingRows.length - 1].after(newRow);
          } else {
            // Als er geen rows zijn, voeg toe na de header-row
            const headerRow = document.querySelector(".header-row");
            if (headerRow) {
              headerRow.after(newRow);
            } else {
              grid.appendChild(newRow);
            }
          }

          // Voeg touch event listeners toe aan de nieuwe row
          attachTouchListeners(newRow);

          // Voeg clampInput toe aan de nieuwe inputs
          newRow.querySelectorAll("input[data-max]").forEach(clampInput);

          // Voeg event listeners toe voor input/blur
          attachRowEventListeners(newRow, existingRows.length);

          // Sla de nieuwe row op in Supabase
          await upsertRow(newRow, existingRows.length);

          // Focus op het naam veld
          const nameInput = newRow.querySelector(".exercise-name");
          if (nameInput) {
            setTimeout(() => nameInput.focus(), 100);
          }

          closeModal();
        });
      };

      // Initialiseer exercise context menu
      setupExerciseContextMenu();

      (async () => {
        console.log("Loading data for day:", day);
        const { data, error } = await supabase
          .from("workout_entries")
          .select("*")
          .eq("day", day)
          .order("exercise_index");
        if (error) {
          console.error("Supabase load failed:", error);
          return;
        }
        console.log("Loaded data:", data);
        data.forEach((item) => {
          const row = rows[item.exercise_index - 1];
          if (!row) return;
          const nameInput = row.querySelector(".exercise-name");
          const noteInput = row.querySelector(".exercise-note");
          const setsInput = row.querySelector('input[name^="sets-"]');
          const repsInput = row.querySelector('input[name^="reps-"]');
          const weightInput = row.querySelector('input[name^="gewicht-"]');

          if (nameInput && item.exercise_name != null) nameInput.value = item.exercise_name;
          if (noteInput && item.note != null) noteInput.value = item.note;
          if (setsInput && item.sets != null) setsInput.value = item.sets;
          if (repsInput && item.reps != null) repsInput.value = item.reps;
          if (weightInput && item.weight != null) weightInput.value = item.weight;
        });
      })();
    })();
  </script>



  <div class="footer-toggle">
    <button class="footer-check" type="button" aria-label="Markeer als afgerond"></button>
  </div>

</body>
</html>
